import{a as z}from"./chunk-C47HJW6C.js";import{a as j,b as B,e as q,g as L,k as O,o as U}from"./chunk-VDU7DDML.js";import{e as F,f as P,g as N,o as Q}from"./chunk-34PDDBBK.js";import{$ as g,$a as d,Ha as l,Ma as w,Ra as R,Va as x,_ as u,aa as f,ba as E,bb as n,cb as a,db as p,eb as y,fb as C,gb as b,hb as h,ib as c,kb as A,lb as V,mb as M,nb as _,ob as m,qb as v,rb as k,sb as D,tb as I,x as T,xb as S}from"./chunk-VZ35BVM6.js";var W=["fileInput"];function H(r,t){r&1&&(n(0,"div",17)(1,"div",18),f(),n(2,"svg",19),p(3,"circle",20)(4,"path",21),a()()())}function J(r,t){if(r&1){let e=b();n(0,"div",55)(1,"label")(2,"input",56),I("ngModelChange",function(s){u(e);let o=c(3);return D(o.selectedMarketName,s)||(o.selectedMarketName=s),g(s)}),a(),m(3),a()()}if(r&2){let e=t.$implicit,i=c(3);l(2),d("value",e.name),k("ngModel",i.selectedMarketName),l(),v(" ",e.name," ")}}function X(r,t){if(r&1&&(n(0,"div")(1,"p",52),m(2,"For guidelines,"),a(),n(3,"div",53),x(4,J,4,3,"div",54),a()()),r&2){let e=c(2);l(4),d("ngForOf",e.markets)}}function K(r,t){if(r&1){let e=b();n(0,"div",57)(1,"span",58),m(2),a(),n(3,"button",59),h("click",function(){u(e);let s=c(2);return g(s.clearUploadedFile())}),f(),n(4,"svg",60),p(5,"line",61)(6,"line",62),a()()()}if(r&2){let e=c(2);l(2),v("Uploaded Filename: ",e.selectedFileName,"")}}function Y(r,t){r&1&&(n(0,"div",63),f(),n(1,"svg",64),p(2,"circle",20)(3,"path",65),a()())}function Z(r,t){r&1&&(n(0,"div",66),f(),n(1,"svg",67),p(2,"path",68)(3,"rect",69),a()())}function $(r,t){r&1&&(n(0,"div",63),f(),n(1,"svg",70),p(2,"circle",20)(3,"path",65),a()())}function ee(r,t){r&1&&(n(0,"div",71),f(),n(1,"svg",72),p(2,"path",73)(3,"path",74)(4,"path",75)(5,"path",76)(6,"path",77)(7,"path",78),a()())}function te(r,t){if(r&1&&(n(0,"h3",79),m(1),a()),r&2){let e=c(2);l(),v(" ",e.currentAction==="redact"?"Redacted Text":e.currentAction==="code"?"Coding Results":"Answer"," ")}}function ne(r,t){r&1&&(n(0,"div",80),p(1,"div",81),a())}function ie(r,t){if(r&1&&(n(0,"pre",82),m(1),a()),r&2){let e=c(2);l(),v("    ",e.responses,`
  `)}}function re(r,t){r&1&&(n(0,"div",80),f(),n(1,"svg",83),p(2,"polyline",84)(3,"polyline",85),a()())}function oe(r,t){r&1&&(n(0,"div",17),f(),n(1,"svg",86),p(2,"circle",20)(3,"path",65),a()())}function se(r,t){r&1&&(f(),n(0,"svg",87),p(1,"path",88)(2,"path",89)(3,"line",90),a())}function ae(r,t){if(r&1){let e=b();y(0),n(1,"div",22)(2,"div",23)(3,"div",24),x(4,X,5,1,"div",16),n(5,"div",25),h("dragover",function(s){u(e);let o=c();return g(o.onDragOver(s))})("drop",function(s){u(e);let o=c();return g(o.onDrop(s))}),f(),n(6,"svg",26),p(7,"path",27)(8,"polyline",28)(9,"line",29),a(),E(),n(10,"p",30),m(11,"Drag & drop your medical document here"),a(),n(12,"p",31),m(13,"Supports PDF files up to 1MB"),a(),n(14,"button",32),h("click",function(){u(e);let s=_(17);return g(s.click())}),m(15," Choose File "),a(),n(16,"input",33,0),h("change",function(s){u(e);let o=c();return g(o.onFileSelected(s))}),a(),x(18,K,7,1,"div",34),a(),n(19,"div",35)(20,"button",36),h("click",function(){u(e);let s=c();return g(s.onSubmit("redact"))}),x(21,Y,4,0,"div",37)(22,Z,4,0,"ng-template",null,1,S),n(24,"p",38),m(25," Redact"),a()(),n(26,"button",39),h("click",function(){u(e);let s=c();return g(s.onSubmit("code"))}),x(27,$,4,0,"div",37)(28,ee,8,0,"ng-template",null,2,S),n(30,"p",40),m(31," Code"),a()()()(),n(32,"div",41),x(33,te,2,1,"h3",42),n(34,"div",43),x(35,ne,2,0,"div",44)(36,ie,2,1,"pre",45)(37,re,4,0,"ng-template",46),a(),n(38,"div",47)(39,"input",48),I("ngModelChange",function(s){u(e);let o=c();return D(o.question,s)||(o.question=s),g(s)}),a(),n(40,"div",49),h("click",function(){u(e);let s=c();return g(s.askQuestion())}),x(41,oe,4,0,"div",50)(42,se,4,0,"ng-template",null,3,S),n(44,"p",51),m(45,"Ask Question"),a()()()()()(),C()}if(r&2){let e=_(23),i=_(29),s=_(43),o=c();l(4),d("ngIf",o.markets),l(14),d("ngIf",o.selectedFileName),l(3),d("ngIf",o.isSubmittingRedact)("ngIfElse",e),l(6),d("ngIf",o.isSubmittingCode)("ngIfElse",i),l(6),d("ngIf",o.responses&&!o.isSubmittingRedact&&!o.isSubmittingCode&&!o.isAskingQuestion),l(2),d("ngIf",o.isSubmittingCode||o.isSubmittingRedact||o.isAskingQuestion),l(),d("ngIf",o.responses&&!(o.isSubmittingCode||o.isSubmittingRedact||o.isAskingQuestion)),l(),d("ngIf",!o.responses&&!(o.isSubmittingCode||o.isSubmittingRedact||o.isAskingQuestion)),l(2),k("ngModel",o.question),l(2),d("ngIf",o.isAskingQuestion)("ngIfElse",s)}}function le(r,t){r&1&&(y(0),n(1,"div",80)(2,"h3",91),m(3," Currently Service Unavailable, Please try again later."),a()(),C())}var G=class r{constructor(t,e,i){this._codeService=t;this.sanitizer=e;this._swalAlertService=i}selectedFileName=null;selectedFileType=null;uploadedFile=null;fieldName="";docType=null;responses;question;redactResponse;codeResponse;isAskingQuestion=!1;isSubmittingRedact=!1;isSubmittingCode=!1;fileInput;currentAction=null;isLoading=!1;isShowUpload=!1;selectedMarketName="USA";markets;ngOnInit(){this.fetchMarkets(),this.navigateToTest()}onFileSelected(t){let e=t.target;e.files&&e.files.length>0&&this.processFile(e.files[0]),this.resetValues()}onDragOver(t){t.preventDefault()}onDrop(t){t.preventDefault(),t.dataTransfer&&t.dataTransfer.files.length>0&&this.processFile(t.dataTransfer.files[0]),this.resetValues()}processFile(t){let e="",i="",s=t.type,o=t.name.split(".").pop()?.toLowerCase();if(s==="application/pdf"||o==="pdf")e="pdf",i="pdf_file";else if(s==="application/rtf"||s==="text/rtf"||o==="rtf")e="rtf",i="rtf_file";else if(s==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||o==="docx")e="docx",i="docx_file";else{this._swalAlertService.warningAlert("Unsupported File","Only PDF, DOCX, and RTF files are allowed.");return}this.selectedFileName=t.name,this.uploadedFile=t,this.docType=e,this.fieldName=i}onSubmit(t){if(!this.uploadedFile||!this.docType){this._swalAlertService.warningAlert("Missing File","Please upload a valid document before redacting.");return}if(this.currentAction=t==="code"?"code":"redact",t==="code"){if(this.redactResponse){this.code(this.redactResponse);return}if(this.isSubmittingRedact||this.isSubmittingCode)return;this.isSubmittingRedact=!0}else{if(this.isSubmittingRedact)return;this.isSubmittingRedact=!0}let e=new FormData;e.append("docType",this.docType),e.append(this.fieldName,this.uploadedFile),this._codeService.redact(e).subscribe({next:i=>{t=="code"?(this.redactResponse=i.redactedText,this.code(i.redactedText)):(this.responses=i.redactedText,this.redactResponse=i.redactedText),this.isSubmittingRedact=!1,console.log("Redaction response:",i)},error:i=>{this.isSubmittingRedact=!1,this._swalAlertService.errorAlert("Redaction Failed","Something went wrong while redacting the document.")}})}code(t){if(!this.redactResponse){this._swalAlertService.warningAlert("Missing Redaction","Please run redact before coding.");return}if(this.isSubmittingCode)return;this.isSubmittingCode=!0;let e=new FormData;e.append("content",t),e.append("market",this.selectedMarketName),this._codeService.codes(e).subscribe({next:i=>{try{let s=JSON.parse(i.response);this.responses=JSON.stringify(s,null,2),this.codeResponse=i.response,this.isSubmittingCode=!1}catch{this.responses=i.response,this.isSubmittingCode=!1}},error:i=>{this._swalAlertService.errorAlert("Failed",i.error.message),this.isSubmittingCode=!1,this.responses="",this.codeResponse=null}})}askQuestion(){if(this.currentAction="ask",this.isAskingQuestion)return;let t=new FormData,e=this.codeResponse||this.redactResponse;if(!e||!this.question){this._swalAlertService.warningAlert("Missing Input","Please run redact/code and enter a question.");return}this.isAskingQuestion=!0,t.append("content",e),t.append("question",this.question),this._codeService.askQuestion(t).subscribe({next:i=>{this.responses=i.answer,this.isAskingQuestion=!1},error:i=>{this.isAskingQuestion=!1,this._swalAlertService.errorAlert("Failed",i.error.message)},complete:()=>{this.isAskingQuestion=!1}})}resetValues(){this.redactResponse=null,this.codeResponse=null,this.responses="",this.question="",this.isSubmittingRedact=!1,this.isSubmittingCode=!1,this.isAskingQuestion=!1,this.currentAction=null}clearUploadedFile(){this.uploadedFile=null,this.selectedFileName="",this.redactResponse=null,this.codeResponse=null,this.responses="",this.question="",this.fileInput&&(this.fileInput.nativeElement.value=""),this.currentAction=null}navigateToTest(){this.isLoading=!0,T([this._codeService.getCodingWorking(),this._codeService.getRedactWorking()]).subscribe({next:([t,e])=>{this.isShowUpload=!0,this.isLoading=!1},error:t=>{this.isLoading=!1,this.isShowUpload=!1}})}fetchMarkets(){this._codeService.getMarkets().subscribe({next:t=>{this.markets=t?.response,this.selectedMarketName=this.markets[0]?.name}})}static \u0275fac=function(e){return new(e||r)(w(z),w(Q),w(U))};static \u0275cmp=R({type:r,selectors:[["app-document-processing"]],viewQuery:function(e,i){if(e&1&&A(W,5),e&2){let s;V(s=M())&&(i.fileInput=s.first)}},decls:16,vars:3,consts:[["fileInput",""],["redactIcon",""],["codeIcon",""],["askIcon",""],[1,"bg-gradient-to-br","from-blue-50","via-indigo-50","to-purple-50","py-20","relative","overflow-hidden","pt-35"],[1,"absolute","inset-0","opacity-10"],[1,"absolute","top-10","left-10","w-32","h-32","bg-blue-400","rounded-full","animate-pulse"],[1,"absolute","top-32","right-20","w-24","h-24","bg-purple-400","rounded-full","animate-bounce",2,"animation-delay","1s"],[1,"absolute","bottom-20","left-1/3","w-20","h-20","bg-indigo-400","rounded-full","animate-ping",2,"animation-delay","2s"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","text-center","relative","z-10"],[1,"text-4xl","lg:text-5xl","font-bold","text-gray-900","mb-6","animate-fade-in"],[1,"bg-gradient-to-r","from-blue-600","to-purple-600","bg-clip-text","text-transparent"],[1,"text-xl","text-gray-600","max-w-2xl","mx-auto","animate-fade-in",2,"animation-delay","0.3s"],[1,"py-10"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],["class","flex justify-center items-center",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-center","items-center"],[1,"mr-3","size-15","animate-spin","text-blue-500"],["viewBox","0 0 24 24","fill","none",1,"w-full","h-full"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z",1,"opacity-75"],[1,"space-y-20","space-x-2"],[1,"flex","lg:flex-row","flex-col","gap-12","items-start","max-w-7xl"],[1,"space-y-4","space-x-2","flex-1","w-full"],[1,"border-2","border-dashed","rounded-xl","p-8","text-center","transition-colors","border-gray-300","hover:border-blue-400","hover:bg-gray-50",3,"dragover","drop"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-upload","h-12","w-12","text-gray-400","mx-auto","mb-4"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","17 8 12 3 7 8"],["x1","12","x2","12","y1","3","y2","15"],[1,"text-lg","font-medium","text-gray-700","mb-2"],[1,"text-sm","text-gray-500","mb-4"],["type","button",1,"inline-flex","items-center","justify-center","gap-2","rounded-md","text-sm","font-medium","border","border-input","bg-background","hover:bg-accent","hover:text-accent-foreground","h-10","px-4","py-2","mt-2","cursor-pointer",3,"click"],["type","file","accept",".pdf,.docx,.rtf,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/rtf",1,"hidden",3,"change"],["class","text-sm text-blue-600 flex justify-center gap-1 items-center mt-2",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4"],[1,"text-center","p-4","bg-white","rounded-xl","shadow-sm","border","border-gray-100","cursor-pointer","transition-all","duration-200","hover:shadow-md","hover:border-transparent","hover:bg-green-50","group",3,"click"],["class","flex justify-center items-center h-8 mb-3",4,"ngIf","ngIfElse"],[1,"text-sm","font-medium","text-gray-700","group-hover:text-green-700","transition-colors","duration-200"],[1,"text-center","p-4","bg-white","rounded-xl","shadow-sm","border","border-gray-100","cursor-pointer","transition-all","duration-200","hover:shadow-md","hover:border-transparent","hover:bg-blue-50","group",3,"click"],[1,"text-sm","font-medium","text-gray-700","group-hover:text-blue-700","transition-colors","duration-200"],[1,"bg-white","rounded-2xl","flex-1","w-full","shadow-xl","px-4","md:px-6","pt-4","pb-3","border","border-gray-100"],["class","text-lg font-semibold text-gray-700 mb-2",4,"ngIf"],[1,"text-start","py-2","h-90","overflow-auto","bg-gray-200","border-1","border-gray-300","rounded-md","text-black","md:px-3","px-1"],["class","flex justify-center items-center h-full",4,"ngIf"],["class","text-gray-500 text-wrap",4,"ngIf"],[3,"ngIf"],[1,"mt-2","flex","md:flex-row","flex-col","items-center","space-x-2"],["type","text","placeholder","Ask your question",1,"flex-1","w-full","border-[1px]","focus:outline-1","border-gray-400","rounded-md","py-2","px-2",3,"ngModelChange","ngModel"],[1,"text-center","flex","p-2","md:p-3","mt-2","md:mt-0","space-x-2","text-white","gap-1","items-center","bg-blue-600","rounded-lg","shadow-sm","border","border-gray-100","cursor-pointer",3,"click"],["class","flex justify-center items-center  ",4,"ngIf","ngIfElse"],[1,"text-sm","font-medium","text-white"],[1,"mb-1"],[1,"flex","space-x-3","ml-2"],["class","flex space-x-3",4,"ngFor","ngForOf"],[1,"flex","space-x-3"],["type","radio","name","markets",1,"cursor-pointer",3,"ngModelChange","value","ngModel"],[1,"text-sm","text-blue-600","flex","justify-center","gap-1","items-center","mt-2"],[1,"truncate","max-w-xs"],["title","Clear file",1,"text-red-500","hover:text-red-700","cursor-pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"h-4","w-4"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"flex","justify-center","items-center","h-8","mb-3"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-6","w-6","text-green-600"],["fill","currentColor","d","M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z",1,"opacity-75"],[1,"h-8","w-8","mb-3","mx-auto","flex","items-center","justify-center","rounded-full","bg-green-100","group-hover:bg-green-200","transition-colors","duration-200"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"text-green-600"],["d","M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"],["x","6","y","9","width","12","height","4","fill","currentColor"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-6","w-6","text-blue-600"],[1,"h-8","w-8","mb-3","mx-auto","flex","items-center","justify-center","rounded-full","bg-blue-100","group-hover:bg-blue-200","transition-colors","duration-200"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"text-blue-600"],["d","M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"],["d","M14 2v6h6"],["d","M8 13h2"],["d","M8 17h2"],["d","M12 13h4"],["d","M12 17h4"],[1,"text-lg","font-semibold","text-gray-700","mb-2"],[1,"flex","justify-center","items-center","h-full"],[1,"w-10","h-10","border-3","border-purple-600","border-t-transparent","rounded-full","animate-spin"],[1,"text-gray-500","text-wrap"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-code","h-16","w-16","text-gray-300","mx-auto","mb-4"],["points","16 18 22 12 16 6"],["points","8 6 2 12 8 18"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-6","w-6","text-white"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"h-4","w-4","text-white","mx-auto"],["d","M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"],["d","M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"],["x1","12","y1","17","x2","12.01","y2","17"],[1,"text-md","md:text-2xl"]],template:function(e,i){e&1&&(n(0,"section",4)(1,"div",5),p(2,"div",6)(3,"div",7)(4,"div",8),a(),n(5,"div",9)(6,"h1",10)(7,"span",11),m(8,"Run a Quick Test \u2013 Try It!"),a()(),n(9,"p",12),m(10,'"Drag & drop your document to review the code."'),a()()(),n(11,"section",13)(12,"div",14),x(13,H,5,0,"div",15)(14,ae,46,13,"ng-container",16)(15,le,4,0,"ng-container",16),a()()),e&2&&(l(13),d("ngIf",i.isLoading),l(),d("ngIf",i.isShowUpload&&!i.isLoading),l(),d("ngIf",!i.isShowUpload&&!i.isLoading))},dependencies:[N,F,P,O,j,L,B,q],encapsulation:2})};export{G as DocumentProcessingComponent};
